<br/>

>[!WARNING|style: flat|label: ç®€è¦è¯´æ˜ ]
>
>[`NuGet - RabbitMQ.Client`] [<span style='color:#008B00'>[ğŸ‘“ å®˜æ–¹è¯´æ˜ ]</span>](https://www.rabbitmq.com/client-libraries/dotnet-api-guide#limitations ':target=_blank')
>
>(`RabbitMQ`) å®˜æ–¹å»ºè®®è¿æ¥ç®¡ç†å¦‚ä¸‹ï¼š
>
>- <span style='color:red'>[`Connection`è¿æ¥åº”é•¿æ—¶é—´ä¿æŒ - å•ä¾‹æ¨¡å¼ ]</span> åº”ç”¨ç¨‹åºåº”åœ¨å¯åŠ¨æ—¶å»ºç«‹è¿æ¥ï¼Œå¹¶åœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…å¤ç”¨è¯¥è¿æ¥ <span style='color:red'>[ ä¸è¦ä¸ºæ¯æ¬¡æ“ä½œ(`å¦‚å‘å¸ƒæ¶ˆæ¯`)éƒ½æ–°å»ºè¿æ¥ ]</span>
>
>- <span style='color:red'>[`Channel`æ¯ä¸ªè¿æ¥å¯åˆ›å»ºå¤šä¸ªé€šé“ ]</span> é€šé“æ˜¯è½»é‡çº§çš„ <span style='color:red'>[ å»ºè®®æ¯ä¸ªçº¿ç¨‹æˆ–ä»»åŠ¡ä½¿ç”¨ç‹¬ç«‹çš„é€šé“ï¼Œä½†å…±äº«åŒä¸€ä¸ªè¿æ¥ ]</span>
>
>  <span style='color:red'>[`Channel`å»ºè®®é•¿æ—¶é—´å¤ç”¨ï¼Œè¿™æ ·å¯ä»¥å‡å°‘èµ„æºæ¶ˆè€—ï¼Œæé«˜æ€§èƒ½ ]</span>
>
><br/>

<!-- tabs:start -->

#### **[ å•ä¾‹ ]IConnection**

```csharp
# connstr: amqp://user:pass@hostName:port/vhost
ConnectionFactory factory = new ConnectionFactory();
// factory.HostName = "192.168.8.172";
// factory.VirtualHost = "/";
# é»˜è®¤AMQPç«¯å£ï¼ˆ éç®¡ç†ç«¯å£ ï¼‰
factory.Port = 5672;
factory.UserName = "root";
factory.Password = "888888";

# [ è¿æ¥è¶…æ—¶æ—¶é—´ ] å»ºè®®è®¾ç½®ä¸º10~30ç§’
factory.RequestedConnectionTimeout = TimeSpan.FromSeconds(15);
# [ è¿æ¥å¿ƒè·³é—´éš” ] å»ºè®®è®¾ç½®ä¸º 30ç§’æˆ–æ›´çŸ­ ( é˜²æ­¢è¿æ¥å‡æ­» - é»˜è®¤ 1 åˆ†é’Ÿ )
factory.RequestedHeartbeat = TimeSpan.FromSeconds(30);
factory.AutomaticRecoveryEnabled = true;  // [ è‡ªåŠ¨æ¢å¤è¿æ¥ ]
factory.TopologyRecoveryEnabled = true;   // [ æ‹“æ‰‘æ¢å¤ ] ä¿è¯é˜Ÿåˆ—ã€äº¤æ¢æœºç­‰è‡ªåŠ¨æ¢å¤

# [ è¯»å†™è¶…æ—¶æ—¶é—´ ]
factory.SocketReadTimeout = TimeSpan.FromSeconds(15);
factory.SocketWriteTimeout = TimeSpan.FromSeconds(15);

var endpoints = new System.Collections.Generic.List<AmqpTcpEndpoint> {
    new AmqpTcpEndpoint("192.168.8.172")
};
IConnection conn = await factory.CreateConnectionAsync(endpoints);

// await conn.CloseAsync();
// await conn.DisposeAsync();


```



#### **[ â˜¢ é€šé“ ]IChannel **

```csharp
public class ChannelPooledObjectPolicy : PooledObjectPolicy<IChannel>
{

     private readonly IConnection _connection;
     public ChannelPooledObjectPolicy(IConnection connection)
     {
          _connection = connection;
     }

     public override IChannel Create()
     {
          var channel = _connection.CreateChannelAsync().GetAwaiter().GetResult();
          return channel;
     }

     public override bool Return(IChannel obj)
     {
         
          # åªå½’è¿˜æ‰“å¼€çš„é€šé“ ( è¶…å‡ºå¯¹è±¡å®¹å™¨ï¼šè‡ªåŠ¨ IDisposable )
          // await channel.CloseAsync();
          // await channel.DisposeAsync();
          return obj.IsOpen;
         
     }
     
}


```

```csharp
IConnection conn = await factory.CreateConnectionAsync(endpoints);
DefaultObjectPool<IChannel> pool = new DefaultObjectPool<IChannel>(new ChannelPooledObjectPolicy(conn));
IChannel channel = pool.Get();
Console.WriteLine("é€šé“æ˜¯å¦æ­£å¸¸æ‰“å¼€ï¼š"+ channel.IsOpen);


```





<!-- tabs:end -->
