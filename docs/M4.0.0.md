<br/>

>[!WARNING|style: flat|label: 简要说明]
>
>- <span style='color:Blue'>[ 路由模式`Routing`]</span> 通过路由绑定的方式 <span style='color:red'>[ 交换机(`Exchange`）+ 队列(`Queue`)：通过路由键`Routing Key`进行绑定 - 实现消息的定向分发 ]</span>
>
>   <span style='color:red'>[ 生产者在发送消息时，需同时指定交换机 + 路由键 - 确保消息能被正确路由到目标队列 ]</span>
>
>   <span style='color:red'>[ 竞争消费：针对同一个队列，各个消费者将对同一条消息是竞争关系 - 谁先抢到该消息谁就处理 ]</span>
>
>   [<span style='color:#008B00'>[👓 官方说明 ]</span>](https://www.rabbitmq.com/tutorials#3-publishsubscribe ':target=_blank')
>
>   ![image-20250923225240886](wwwroot\docImages\image-20250923225240886.png)
>
>
>⚠<span style='color:red'>[ 此模式使用直连交换机`Direct Exchangee`：通过路由键`Routing Key`实现消息的定向分发 ]</span>
>
>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style='color:red'>[ 可以使用相同的路由键：同时将`N`个队列绑定到同一个交换机 - 模拟消息广播 ]</span>
>
>⚠<span style='color:red'>[`Exchange`只负责消息的路由和转发，不具备存储消息的能力 ]</span>
>
>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style='color:red'>[ 如果没有队列绑定到交换机，交换机收到消息后无法转发到任何队列，这些消息会被直接丢弃，无法被任何消费者接收 ]</span>
>
><br/>

```csharp
async Task M1(IConnection conn, CancellationToken token)
{

     for (int i = 0; i < 10; i++)
     {

          IChannel channel = pool.Get();
          try
          {
               // [ A.1 ] 声明队列  Q1
               await channel.QueueDeclareAsync("Q1", durable: true, exclusive: false, autoDelete: false, arguments: null);
               // [ A.2 ] 声明队列  Q2
               await channel.QueueDeclareAsync("Q2", durable: true, exclusive: false, autoDelete: false, arguments: null);
               // [ A.3 ] 声明队列  Q3
               await channel.QueueDeclareAsync("Q3", durable: true, exclusive: false, autoDelete: false, arguments: null);
               // [ B ] 声明交换机 Direct
               await channel.ExchangeDeclareAsync("E2", ExchangeType.Direct);
               // [ C ] 路由绑定
               await channel.QueueBindAsync(queue: "Q1", exchange: "E2", routingKey: "Email");
               await channel.QueueBindAsync(queue: "Q2", exchange: "E2", routingKey: "Email");
               await channel.QueueBindAsync(queue: "Q3", exchange: "E2", routingKey: "QQ");

               // [ 发布消息 ]
               string message = $"Hello World! {i}";
               ReadOnlyMemory<byte> body = System.Text.Encoding.UTF8.GetBytes(message);

               var properties = new BasicProperties
               {
                    Persistent = true,
                    ContentType = "text/plain",
                    ContentEncoding = "utf-8",

                    MessageId = Guid.CreateVersion7().ToString("N"),
                    CorrelationId = "0201-03",
                    Timestamp = new AmqpTimestamp(DateTimeOffset.UtcNow.ToUnixTimeSeconds()),
                    AppId = "TConsoleApp",
                    Type = "Test"
               };
               await channel.BasicPublishAsync(exchange: "E2", routingKey: "Email", false, basicProperties: properties, body: body);
               Console.WriteLine(" 已发送消息: {0}", message);

          }
          finally
          {
               pool.Return(channel);
          }
          await Task.Delay(3000);

     }

}


```

