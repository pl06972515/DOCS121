<br/>

>[!WARNING|style: flat|label: 简要说明 ]
>
>- <span style='color:red'>只允许 [ 特定声明`ClaimsIdentity.Claims`]</span>
>
>```csharp
>public class ClaimsAuthorizationRequirement : IAuthorizationRequirement,
>                                               AuthorizationHandler<ClaimsAuthorizationRequirement>      
>{
>
>      public string ClaimType { get; }
>      public IEnumerable<string>? AllowedValues { get; }    
>      public ClaimsAuthorizationRequirement(string claimType, IEnumerable<string>? allowedValues);
>
>      protected override Task HandleRequirementAsync(AuthorizationHandlerContext context, ClaimsAuthorizationRequirement _this)
>      {
>
>           if (context.User != null)
>           {
>
>                ClaimsPrincipal user = context.User;
>                Claim? claim = user.FindFirst(this.ClaimType);
>                if (claim != null)
>                {
>                     
>				     if (this.AllowedValues != null && AllowedValues.Any())
>                     {
>
>                          foreach (string v in this.AllowedValues)
>                          {
>                               if (claim.Value == v)
>                               {
>                                    context.Succeed(_this);
>                                    break;
>                               }
>                          }
>
>                     }
>                     else context.Succeed(_this);
>                     
>                }
>
>           }
>           return Task.CompletedTask;
>
>      }
>
>}
>
>
>```
>
>
>
><br/>



